<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>PasuGame</title>
<style>
  html, body {
    margin:0; padding:0; height:100%; overflow:hidden;
    font-family: sans-serif;
    background: url('Background.webp') no-repeat center center/cover;
  }
  #game {
    position: relative; width: 100vw; height: 100vh; overflow: hidden;
  }
  #ground {
    position: absolute; bottom:0; left:0; right:0; height: 12vh;
    background: url('ground.jpg') repeat-x bottom/auto 12vh; z-index: 10;
  }
  #player {
    position: absolute; bottom: 12vh; left: 15vw;
    width: 14vw; aspect-ratio: 391 / 322;
    background-repeat: no-repeat;
    background-position: center bottom;
    background-size: contain;
    transition: bottom 0.15s ease;
    z-index: 20;
  }
  #player.slide { height: calc(14vw * 0.5); }

  .obstacle {
    position: absolute; bottom: 12vh; width: 5vw; height: 10vw;
    background: sienna; border-radius: 0.5vw; z-index: 15;
  }
  .coin {
    position: absolute; bottom: 18vh; width: 4vw; height: 4vw;
    background: gold; border-radius: 50%;
    box-shadow: 0 0 8px 2px #FFC800; z-index: 15;
  }

  #coinCount, #score {
    position: fixed; top: 10px; color: white; font-weight: 700;
    font-size: 24px; user-select:none; text-shadow: 0 0 4px black;
    z-index: 1000;
  }
  #coinCount { left: 10px; }
  #score { right: 10px; }

  #lobby {
    position: fixed; inset: 0;
    background: rgba(0,0,0,0.75);
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    gap: 20px; font-size: 32px; color: white; z-index: 2000;
  }

  button {
    padding: 12px 36px; font-size: 24px; border-radius: 12px;
    border: none; cursor: pointer; font-weight: 700;
    background: linear-gradient(135deg, #D97448, #B14B1C); color: white;
    box-shadow: 0 4px 8px #572B0D; user-select:none;
  }

  #charSelect {
    display: flex; flex-wrap: wrap; justify-content: center; gap: 20px;
  }
  .charOption {
    width: 90px; height: 90px; border: 3px solid transparent;
    border-radius: 12px;
    background-size: contain; background-repeat: no-repeat;
    background-position: center bottom; cursor: pointer;
    box-shadow: 0 0 8px #FFD966;
  }
  .charOption.selected { border-color: #FFD966; }

  #jumpBtn, #slideBtn {
    position: fixed; bottom: 20px; width: 90px; height: 90px;
    border-radius: 50%; border: none;
    background-size: contain; background-repeat: no-repeat;
    background-position: center; z-index: 1500; user-select:none;
  }
  #jumpBtn { right: 120px; background-image: url('jump.png'); }
  #slideBtn { right: 20px; background-image: url('slide.png'); }

  #gameOverScreen {
    position: fixed; inset: 0;
    background: rgba(0,0,0,0.75); color: white;
    font-size: 36px; font-weight: 700;
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    gap: 20px; z-index: 3000; display:none;
  }
</style>
</head>
<body>
<div id="game">
  <div id="ground"></div>
  <div id="player"></div>
  <div id="coinCount">Coins: 0</div>
  <div id="score">Score: 0</div>

  <button id="jumpBtn" aria-label="Jump"></button>
  <button id="slideBtn" aria-label="Slide"></button>

  <div id="lobby">
    <div>Select Your Character</div>
    <div id="charSelect">
      <div class="charOption selected" data-char="myDino.png" style="background-image:url('myDino.png')"></div>
      <div class="charOption" data-char="peet.png" style="background-image:url('peet.png')"></div>
      <div class="charOption" data-char="broin.png" style="background-image:url('broin.png')"></div>
      <div class="charOption" data-char="20250707_123932.png" style="background-image:url('20250707_123932.png')"></div>
      <div class="charOption" data-char="20250707_123608.png" style="background-image:url('20250707_123608.png')"></div>
    </div>
    <button id="playBtn">Play</button>
  </div>

  <div id="gameOverScreen">
    <div>Game Over!</div>
    <button id="restartBtn">Restart</button>
    <button id="backLobbyBtn">Back to Lobby</button>
  </div>
</div>

<audio id="jumpSound" src="jump.mp3" preload="auto"></audio>
<audio id="slideSound" src="slide.mp3" preload="auto"></audio>

<script>
(() => {
  const player = document.getElementById('player');
  const coinDisplay = document.getElementById('coinCount');
  const scoreDisplay = document.getElementById('score');
  const lobby = document.getElementById('lobby');
  const playBtn = document.getElementById('playBtn');
  const restartBtn = document.getElementById('restartBtn');
  const backLobbyBtn = document.getElementById('backLobbyBtn');
  const jumpBtn = document.getElementById('jumpBtn');
  const slideBtn = document.getElementById('slideBtn');
  const jumpSound = document.getElementById('jumpSound');
  const slideSound = document.getElementById('slideSound');

  const charOptions = document.querySelectorAll('.charOption');

  let isJumping = false;
  let isSliding = false;
  let gravity = 0.6;
  let velocityY = 0;
  let gameRunning = false;
  let obstacles = [], coins = [];
  let spawnTimer = 0, coinTimer = 0;
  let score = 0, coinsCollected = 0;
  let playerChar = 'myDino.png';
  let slideTimeout = null;

  function setPlayerCharacter(src) {
    playerChar = src;
    player.style.backgroundImage = `url('${src}')`;
  }

  charOptions.forEach(opt => {
    opt.onclick = () => {
      charOptions.forEach(c => c.classList.remove('selected'));
      opt.classList.add('selected');
      setPlayerCharacter(opt.dataset.char);
    };
  });

  function resetGame() {
    gameRunning = true;
    isJumping = false;
    isSliding = false;
    velocityY = 0;
    score = 0;
    coinsCollected = 0;
    spawnTimer = 0;
    coinTimer = 0;
    obstacles.forEach(o => o.element.remove());
    coins.forEach(c => c.element.remove());
    obstacles = [];
    coins = [];

    coinDisplay.textContent = 'Coins: 0';
    scoreDisplay.textContent = 'Score: 0';

    lobby.style.display = 'none';
    jumpBtn.style.display = 'block';
    slideBtn.style.display = 'block';
    scoreDisplay.style.display = 'block';
    player.classList.remove('slide');
    player.style.bottom = '12vh';
    setPlayerCharacter(playerChar);
    requestAnimationFrame(update);
  }

  function endGame() {
    gameRunning = false;
    jumpBtn.style.display = 'none';
    slideBtn.style.display = 'none';
    document.getElementById('gameOverScreen').style.display = 'flex';
  }

  function spawnObstacle() {
    const el = document.createElement('div');
    el.classList.add('obstacle');
    el.style.left = '100vw';
    game.appendChild(el);
    obstacles.push({element: el, x: window.innerWidth});
  }

  function spawnCoin() {
    const el = document.createElement('div');
    el.classList.add('coin');
    el.style.left = '100vw';
    game.appendChild(el);
    coins.push({element: el, x: window.innerWidth});
  }

  function update() {
    if (!gameRunning) return;

    obstacles.forEach((o, i) => {
      o.x -= 5;
      if (o.x < -100) {
        o.element.remove();
        obstacles.splice(i, 1);
        return;
      }
      o.element.style.left = o.x + 'px';

      const p = player.getBoundingClientRect();
      const r = o.element.getBoundingClientRect();
      if (
        p.right > r.left + 5 &&
        p.left < r.right - 5 &&
        p.bottom > r.top + 5 &&
        p.top < r.bottom - 5
      ) {
        endGame();
      }
    });

    coins.forEach((c, i) => {
      c.x -= 5;
      if (c.x < -100) {
        c.element.remove();
        coins.splice(i, 1);
        return;
      }
      c.element.style.left = c.x + 'px';

      const p = player.getBoundingClientRect();
      const r = c.element.getBoundingClientRect();
      if (
        p.right > r.left + 5 &&
        p.left < r.right - 5 &&
        p.bottom > r.top + 5 &&
        p.top < r.bottom - 5
      ) {
        c.element.remove();
        coins.splice(i, 1);
        coinsCollected++;
        coinDisplay.textContent = `Coins: ${coinsCollected}`;
      }
    });

    spawnTimer++;
    if (spawnTimer > 120) {
      spawnObstacle();
      spawnTimer = 0;
    }

    coinTimer++;
    if (coinTimer > 200) {
      spawnCoin();
      coinTimer = 0;
    }

    if (isJumping) {
      velocityY -= gravity;
      let b = parseFloat(player.style.bottom) || 0;
      b += velocityY;
      if (b <= window.innerHeight * 0.12) {
        b = window.innerHeight * 0.12;
        isJumping = false;
        velocityY = 0;
      }
      player.style.bottom = b + 'px';
    }

    score++;
    scoreDisplay.textContent = `Score: ${Math.floor(score/10)}`;
    requestAnimationFrame(update);
  }

  function jump() {
    if (!gameRunning || isJumping) return;
    isJumping = true;
    velocityY = 18;
    jumpSound.currentTime = 0;
    jumpSound.play();
    player.classList.remove('slide');
    isSliding = false;
    if (slideTimeout) clearTimeout(slideTimeout);
  }

  function slide() {
    if (!gameRunning || isSliding || isJumping) return;
    isSliding = true;
    slideSound.currentTime = 0;
    slideSound.play();
    player.classList.add('slide');
    slideTimeout = setTimeout(() => {
      isSliding = false;
      player.classList.remove('slide');
    }, 1000);
  }

  playBtn.onclick = resetGame;
  restartBtn.onclick = resetGame;
  backLobbyBtn.onclick = () => {
    document.getElementById('gameOverScreen').style.display = 'none';
    lobby.style.display = 'flex';
    jumpBtn.style.display = 'none';
    slideBtn.style.display = 'none';
    scoreDisplay.style.display = 'none';
  };

  jumpBtn.onclick = jump;
  slideBtn.onclick = slide;
  window.addEventListener('keydown', e => {
    if (!gameRunning) return;
    if (e.code === 'Space' || e.code === 'ArrowUp') jump();
    if (e.code === 'ArrowDown') slide();
  });

  setPlayerCharacter('myDino.png');
  jumpBtn.style.display = 'none';
  slideBtn.style.display = 'none';
  scoreDisplay.style.display = 'none';
})();
</script>
</body>
</html>
